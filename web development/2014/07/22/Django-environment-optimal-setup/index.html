
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Django environment optimal setup - GuoChen | Blog</title>
  <meta name="author" content="GuoChen">

  
  <meta name="description" content="Django environment optimal setup - GuoChen | Blog">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Open Graph Data -->
  <meta name="og:title" property="og:title" content="Django environment optimal setup - GuoChen | Blog" />
  <meta name="og:type" property="og:type" content="article" />
  <meta property="og:url" property="og:url" content="http://blog.hguochen.com//web%20development/2014/07/22/Django-environment-optimal-setup/" />
  <meta property="og:image" property="og:image" content="http://blog.hguochen.com/static/img/gc.png"/>
  <meta name="og:description" property="og:description" content="Django environment optimal setup" />
  <meta name="og:site_name"property="og:site_name" content="Django environment optimal setup - GuoChen | Blog" />

  
  <link rel="canonical" href="http://blog.hguochen.com/web%20development/2014/07/22/Django-environment-optimal-setup/">
  <link rel="icon" type="image/ico" href="/static/img/favicon.ico">
  <link rel="alternate" type="application/rss+xml" title="GuoChen's Blog" href="http://blog.hguochen.com/feed.xml">
  <link rel="image_src" href="/static/img/gc.png"/>

  <!-- CSS -->
  <link rel="stylesheet" href="/static/css/normalize.css">
  <link rel="stylesheet" href="/static/css/bootstrap.min.css">
  <link media="screen, projection" rel="stylesheet" type="text/css"  href="/static/css/screen.css">
  <link rel="stylesheet" href="/static/css/custom.css">

  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
  <link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
  <link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-46926911-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>



  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
</head>

<body 


>
  <header role="banner"><hgroup>
	<div class="container">
		<div class="row">
			<br>
			
			<div class="col-md-2 col-xs-2"></div>
			<div class="col-md-2 col-xs-2"></div>			
			<div class="col-md-1 col-xs-3">
				<span class="me image image-small"><a href="/"><img src="/static/img/gc.png" alt="" /></a></span>
			</div>
			<div class="col-md-1 col-xs-1"></div>
			<div class="col-md-2 col-xs-2"></div>
			<div class="col-md-2 col-xs-2"></div>
			
		</div>
	</div>
</hgroup>
</header>
  
  <section class="container top_padding">
    <div class="row">
      <div class="col-sm-1"></div>
      <div class="col-sm-10">
        <div>
<article class="hentry" role="article">
  
  
  <header>
    
      <h1 class="entry-title">Django environment optimal setup</h1>
    
    
      <p class="meta">
        Jul 22, 2014
        
        








  


<time datetime="2014-07-22T17:08:54Z" pubdate data-updated="true"></time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p><a href="https://www.djangoproject.com">Django</a> is a great web framework based on MVC architecture that allows you to quickly and correctly build and deploy web projects. However, staring a new Django project can be a little daunting and often the wrong setup can lead to long term problems for your project. Here i&rsquo;m sharing with you my preferred workflow on starting a new Django project. A small bit of planning goes a long way towards making life easier!</p>

<h3>Prerequisites</h3>

<p>A working knowledge of python language and Django framework is assumed. You will also have to know <a href="http://git-scm.com">git</a> for version control.</p>

<h3>Install Python</h3>

<p>Head over to <a href="http://python.org">python.org</a> and find the install instructions for your specific OS. For my development environment, i&rsquo;m running MAC OSX Mavericks.</p>

<p>To check you have installed python correctly, type</p>

<pre><code>$ python
</code></pre>

<p>into terminal command line and you should get the following output:</p>

<pre><code>Python 2.7.5 (default, Mar  9 2014, 22:15:05) 
[GCC 4.2.1 Compatible Apple LLVM 5.0 (clang-500.0.68)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt;
</code></pre>

<h3>Install pip</h3>

<p><a href="http://pip.readthedocs.org/en/latest/index.html">Pip</a> is a great tool for installing and managing python packages. We are going to use pip to install all third party packages to supplement our project.</p>

<p>The easy way to install pip is to first download <a href="https://bootstrap.pypa.io/get-pip.py">get-pip.py</a>. Then run the following command in the folder with the downloaded file on your terminal:</p>

<pre><code>$ python get-pip.py
</code></pre>

<p>And you are done installing! You can test pip installed correctly with the command:</p>

<pre><code>pip -V
</code></pre>

<p>which shows the version of your pip.</p>

<h3>Install virtualenv</h3>

<p><a href="http://virtualenv.readthedocs.org/en/latest/">Virutalenv</a> is a great tool to sandbox your development environments so you don&rsquo;t have to switch back and forth between different versions of softwares. What&rsquo;s more, the excellent extension <a href="http://virtualenvwrapper.readthedocs.org/en/latest/">virtualenvwrapper</a> makes using virtualenv alot easier. This is common, recommend practice among python, Django users alike.</p>

<p>We are also going to use <a href="https://pypi.python.org/pypi">pip</a> to install packages.</p>

<p>First, let&rsquo;s install virtualenv. Note that you can get both virtualenv and virtualenvwrapp install just by install ing virtualenvwrapper.</p>

<pre><code>$ pip install virtualenvwrapper
</code></pre>

<p>After it&rsquo;s installed, add following lines to your .bashrc file:</p>

<pre><code>export WORKON_HOME=$HOME/.virtualenvs
export PROJECT_HOME=$HOME/directory-you-do-development-in
source /usr/local/bin/virtualenvwrapper.sh
</code></pre>

<p>Then type the following command to &lsquo;activate&rsquo; your modified .bashrc file:</p>

<pre><code>$ source .bashrc
</code></pre>

<h3>Creating new environment</h3>

<p>To create a new virtual environment, type:</p>

<pre><code>$ mkvirtualenv django_project
</code></pre>

<p>where django_project is whatever name your project is. You should see your shell is now prepended by (django_project).</p>

<p>The django_project prepending is a reminder that you are using virtualenv instal of your system&rsquo;s Python installation. To exit, the virtual environment, simple type deactivate. When you want to resume work on your project, it&rsquo;s as easy as typing</p>

<pre><code>$ workon django_project
</code></pre>

<p>Where you run the command doesn&rsquo;t matter.</p>

<h3>Install Django</h3>

<p>Since we are working in virtualenv, we have to install Django into this virtual environment. This makes sure that the version of Django we use for this project is not confused with other versions used by the system or other virtual environments.</p>

<pre><code>$ pip install django
</code></pre>

<p>This should give you the latest version of Django which will be installed in your virtualenv area. You can confirm this by doing:</p>

<pre><code>$ which django-admin.py
</code></pre>

<p>Which should point to your $HOME/.virtualenvs/ directory.</p>

<h3>Setup project folder</h3>

<p>Now we can create our project directory. I highly recommend using <a href="https://github.com/twoscoops/django-twoscoops-project">two scoops Django</a> project template for all Django projects. If you are new to two scoops django, it is actually a compilation of some of the best practices for developing Django projects. You can purchase a copy of this amazing book <a href="http://twoscoopspress.org/">here</a>.</p>

<p>Now go ahead and setup the project with this command:</p>

<pre><code>$ django-admin.py startproject --template=https://github.com/twoscoops/django-twoscoops-project/archive/master.zip --extension=py,rst,html django_project
</code></pre>

<p>Note that this command creates a django_project directory with the two scoops django template. I&rsquo;ll leave you to read more about <a href="https://github.com/twoscoops/django-twoscoops-project">two scoops django template</a> yourself.</p>

<h3>Source control</h3>

<p>Git is automatically installed in your virtual environment when you created it with virtualenvwrapper earlier.</p>

<p>Since our folder and file structure is up now, let&rsquo;s commit them to source control right from the start. Here&rsquo;s how to do that in git:</p>

<pre><code>$ git init
</code></pre>

<p>Creates a git repository in the current directory. Now let&rsquo;s stage all of our files to git to be commited.</p>

<pre><code>$ git add django_project
</code></pre>

<p>Now we commit them to our new repository:</p>

<pre><code>$ git commit -m "Initial commit of django_project"
</code></pre>

<p>Let&rsquo;s add the remote repository in <a href="http://github.com">github</a>:</p>

<pre><code>$ git remote add origin &lt;remote repository URL&gt;
</code></pre>

<p>Finally, let&rsquo;s push our changes!</p>

<pre><code>$ git push origin master
</code></pre>

<h3>South for database migrations</h3>

<p>South is a great tool that detects changes to your models layer and automatically sync the changes to your database without you having to dabble with the database itself. This is done through a migration file that South creates. This lets you both migrate the database forward for new change and backward to undo a change or series of changes.</p>

<p>In our virtualenv, install south using pip:</p>

<pre><code>$ pip install south
</code></pre>

<p>Then setup south with the project by adding it to our INSTALLED_APPS in settings/base.py file for the project.
After which, run the command:</p>

<pre><code># python manage.py syncdb
</code></pre>

<p>to sync the changes and south will be registered along with the project. South will also automatically setup the database with the tables it needs.</p>

<p>Before we commit, we will want tot rack our install Python packages. We want to track the name and version of the python packages we are using so we can recreate our environment easily in the production area. There&rsquo;s a pip command that does this:</p>

<pre><code>$ pip freeze &gt; requirements.txt
</code></pre>

<p>I pushed the output of pip freeze to a file called requirements.txt which we will add to source control so we always have an updated list of packages being used.</p>

<p>As before, we commit the changes to git and push to remote repository.</p>

<h3>Install Fabric</h3>

<p>To easily deploy a Django application, we use <a href="http://fabric.readthedocs.org/en/1.3.3/api/contrib/django.html">Fabric</a>. Fabric has a number of purposes but it really helps in quick deployments. Install Fabric with the command:</p>

<pre><code>$ pip install fabric
</code></pre>

<p>Fabric expects a fabfile.py which defines all of the actions we can take. Let&rsquo;s create that file and put the following in fabfile.py in your project&rsquo;s root directory.</p>

<pre><code>from fabric.api import local

def prepare_deployment(branch_name):
local('python manage.py test django_project')
local('git add -p &amp;&amp; git commit') # or local('hg add &amp;&amp; hg commit')
</code></pre>

<p>This will run the test and commit your changes only if your tests pass. A simple &ldquo;pull&rdquo; in your production area becomes your deployment. Let&rsquo;s add the following code to fabfile.py to actually deploy:</p>

<pre><code>from fabric.api import lcd, local

def deploy():
with lcd('/path/to/my/prod/area/'):

    # With git...
    local('git pull /my/path/to/dev/area/')

    # With Mercurial...
    local('hg pull /my/path/to/dev/area/')
    local('hg update')

    # With both
    local('python manage.py migrate myapp')
    local('python manage.py test myapp')
    local('/my/command/to/restart/webserver')
</code></pre>

<p>This will pull your changes from the development master branch, run any migrations you&rsquo;ve made, run tests, and restart your web server.</p>

<p>To use this file, we simply type the following in production environment:</p>

<pre><code>$ fab prepare_deployment
$ fab deploy
</code></pre>

<p>So that&rsquo;s it! The skeleton for an optimal django environment is setup and ready to be developed! Remember, commit often, test everything. Let me know if i&rsquo;ve missed out something! Rock on folks!</p>

<p>P/S: For your convenience, i have setup a <a href="https://github.com/hguochen/django_template">django_template</a> on github based on the above instructions. You may wish to fork it for your own use!</p>

<p>EDIT: Thanks to Chng Nai Yun, i&rsquo;ve corrected a silly error which incorrectly states that git is installed when you install virtualenvwrapper. In reality, git is only installed when you setup the virtualenv environment.</p>
</div>


  <p class="meta">
    
  

<span class="byline author vcard">Posted by <span class="fn"><a href="http://blog.hguochen.com">GuoChen</a></span></span>

    








  


<time datetime="2014-07-22T17:08:54Z" pubdate data-updated="true"></time>
    

<br>
<span class="glyphicon glyphicon-tag"></span>
<span class="categories">
  
    <a class='category' href='/categories/web-development/'>web development</a>
  
</span>


  </p>
    
      <div class="sharing" style="text-align:left;">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://blog.hguochen.com/web%20development/2014/07/22/Django-environment-optimal-setup/" data-via="hguochen" data-counturl="http://blog.hguochen.com/web%20development/2014/07/22/Django-environment-optimal-setup/" >Tweet</a>
  
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

  
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">

</aside>


      </div>
      <div class="col-sm-1"></div>
    </div>
  </section>
  <footer role="contentinfo" class="footer_color">    <p style="text-align:center; margin-bottom:0;">
    	<span>Handcrafted by GuoChen &copy; 2014</span>
  		<br>
  		<span class="credit">Powered by <a style="color:#a1a1a1;" href="http://jekyllrb.com">Jekyll</a> - <a style="color:#a1a1a1;" href="/feed.xml">RSS Feed</a></span>
	</p>
	
	<script src="https://code.jquery.com/jquery.js"></script>
	<script src="/static/js/bootstrap.min.js"></script>
	<script src="/static/js/modernizr-2.0.js"></script>
	<script src="/static/js/sticky_titles.js"></script>
  </body>
</html></footer>
  
  

<script type="text/javascript">
      var disqus_shortname = 'hguochen';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://blog.hguochen.com/web%20development/2014/07/22/Django-environment-optimal-setup/';
        var disqus_url = 'http://blog.hguochen.com/web%20development/2014/07/22/Django-environment-optimal-setup/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>



</body>
</html>
